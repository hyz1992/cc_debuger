'use strict';Object['defineProperty'](exports,Symbol['toStringTag'],{'value':'Module'});const e=require('./_funcs-Czg27ZAi.cjs'),t=require('fs-extra'),n=require('path'),s='cc_debuger_1.ts',a='cc_debuger_2_ugly.ts',r=n['join'](e['_funcs']['getCurPluginPath'](),'runtime/',s),i=n['join'](e['_funcs']['getCurPluginPath'](),'runtime/',a),o=n['join'](Editor['Project']['path'],'assets',s),l=o+'.meta',c=n['join'](Editor['Project']['path'],'assets',a),u=c+'.meta';let g,d;const _=async()=>{try{console['log']('['+e['_funcs']['getPluginName']()+']\x20Removing\x20runtime\x20script...'),t['existsSync'](o)&&(t['unlinkSync'](o),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20removed:\x20'+o)),t['existsSync'](c)&&(t['unlinkSync'](c),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20removed:\x20'+c)),t['existsSync'](l)&&(t['unlinkSync'](l),console['log']('['+e['_funcs']['getPluginName']()+']\x20Meta\x20file\x20removed:\x20'+l)),t['existsSync'](u)&&(t['unlinkSync'](u),console['log']('['+e['_funcs']['getPluginName']()+']\x20Meta\x20file\x20removed:\x20'+u)),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+a);}catch(_0x4cb548){console['error']('['+e['_funcs']['getPluginName']()+']\x20Error\x20removing\x20runtime\x20script:',_0x4cb548);}},{pathExistsSync:f,writeFileSync:p,readFileSync:m}=require('fs-extra'),y={async 'open_main'(){console['log']('点击打开主面板'),Editor['Panel']['open'](e['packageJSON']['name']);},async 'restart_self_ui'(){console['log']('收到消息restart_self_ui'),await Editor['Panel']['close'](e['packageJSON']['name']);const _0x447c1d={[e['packageJSON']['name']+'.eval_panel']:!0x1,[e['packageJSON']['name']+'.log_panel']:!0x1,[e['packageJSON']['name']+'.dynamicTexture_panel']:!0x1,[e['packageJSON']['name']+'.localCache_panel']:!0x1};for(let _0x1ac6eb in _0x447c1d)_0x447c1d[_0x1ac6eb]=await Editor['Panel']['has'](_0x1ac6eb),_0x447c1d[_0x1ac6eb]&&Editor['Panel']['close'](_0x1ac6eb);setTimeout(async()=>{console['log']('时间到重启'),await Editor['Panel']['open'](e['packageJSON']['name']);for(let _0x160eb6 in _0x447c1d)_0x447c1d[_0x160eb6]&&(await new Promise(_0x31a794=>{setTimeout(()=>{_0x31a794(null);},0x7d0);}),await Editor['Panel']['open'](_0x160eb6));},0x7d0);},async 'onBeforeBuild'(_0x5d473e){var _0x3e6acf;const _0x5d4b3f=null==(_0x3e6acf=null==_0x5d473e?void 0x0:_0x5d473e['packages'])?void 0x0:_0x3e6acf['cc_debuger_realtime'];return await(async _0x3ef75d=>{const _0x563137=null==_0x3ef75d?void 0x0:_0x3ef75d['cut_plugin_from_runtime'],_0x142aa6=null==_0x3ef75d?void 0x0:_0x3ef75d['bAutoStarPlugin'],_0xd438ea=null==_0x3ef75d?void 0x0:_0x3ef75d['serverAddress'];if(t['existsSync'](o)){if(g=t['readFileSync'](o,'utf-8'),d=t['readFileSync'](l,'utf-8'),_0x563137)await _();else{let _0x5ad42c=t['readFileSync'](o,'utf-8')['replace'](/bAutoStart\s*=\s*(true|false)/,'bAutoStart\x20=\x20'+_0x142aa6);_0x5ad42c=_0x5ad42c['replace'](/plugin_server_address\s*=\s*([`"'])(.*?)\1/,'plugin_server_address\x20=\x20`'+_0xd438ea+'`'),t['writeFileSync'](o,_0x5ad42c,'utf-8'),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s);}return 0x0;}})(_0x5d4b3f);},async 'onAfterBuild'(_0x15d8ba,_0x305696,_0x3ed953){var _0x3d3518,_0x32c334;const _0x4fcd7b=null==(_0x3d3518=null==_0x3ed953?void 0x0:_0x3ed953['cache'])?void 0x0:_0x3d3518['applicationJS'];if(await f(_0x4fcd7b)){let _0x8be7f3=m(_0x4fcd7b);_0x8be7f3=_0x8be7f3+'\x0a'+w,p(_0x4fcd7b,_0x8be7f3);}return null==(_0x32c334=null==_0x15d8ba?void 0x0:_0x15d8ba['packages'])||_0x32c334['cc_debuger_realtime'],((async()=>{g&&t['writeFileSync'](o,g,'utf-8'),d&&t['writeFileSync'](l,d,'utf-8'),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s);})());}},w='\x0awindow[\x22cc_debuger_intercept_log\x22]\x20=\x20function(){\x0a\x20\x20if(!window[\x22cc_debuger_log_intercepted\x22]){\x0a\x20\x20\x20\x20window[\x22cc_debuger_log_intercepted\x22]\x20=\x20true;\x0a\x20\x20\x20\x20\x20\x20[\x22log\x22,\x20\x22warn\x22,\x20\x22error\x22].forEach(level\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20const\x20originalMethod\x20=\x20console[level];\x0a\x0a\x20\x20\x20\x20\x20\x20console[level]\x20=\x20(...args)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20if(window[\x22cc_debuger_handleLog\x22]){\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20window[\x22cc_debuger_handleLog\x22](level,\x20args);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20originalMethod.apply(console,\x20args);\x0a\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20});\x0a\x20\x20}\x0a}\x0awindow[\x22cc_debuger_intercept_log\x22]()\x0a';exports['load']=function(){console['log']('插件\x20['+e['packageJSON']['name']+']\x20已安装'),((async()=>{try{console['log']('['+e['_funcs']['getPluginName']()+']\x20Injecting\x20runtime\x20script...');let _0x2b3f9f=!0x1;for(let _0x8644d=0x0;_0x8644d<0x78&&(_0x2b3f9f=await Editor['Message']['request']('asset-db','query-ready'),!_0x2b3f9f);_0x8644d++)await e['_funcs']['waitForSeconds'](0x1);if(!_0x2b3f9f)return;{const _0x559d1f=t['readFileSync'](i,'utf-8');t['writeFileSync'](c,_0x559d1f,'utf-8'),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20written\x20to\x20'+c),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+a);}{const _0x6dce69=t['readFileSync'](r,'utf-8');t['writeFileSync'](o,_0x6dce69,'utf-8'),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20written\x20to\x20'+o),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s);}}catch(_0x47ca45){console['error']('['+e['_funcs']['getPluginName']()+']\x20Error\x20injecting\x20runtime\x20script:',_0x47ca45);}})());},exports['methods']=y,exports['unload']=function(){console['log']('插件\x20['+e['packageJSON']['name']+']\x20已卸载'),_();};