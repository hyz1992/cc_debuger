'use strict';Object['defineProperty'](exports,Symbol['toStringTag'],{'value':'Module'});const e=require('./_funcs-B2Sc0Zw2.cjs'),t=require('fs-extra'),n=require('path'),s='cc_debuger_1.ts',a='cc_debuger_2_ugly.ts',r='ccdebuger.pako.min.js',i=n['join'](e['_funcs']['getCurPluginPath'](),'src/tools/',r),o=n['join'](e['_funcs']['getCurPluginPath'](),'runtime/',s),c=n['join'](e['_funcs']['getCurPluginPath'](),'runtime/',a),l=n['join'](Editor['Project']['path'],'assets',s),u=l+'.meta',g=n['join'](Editor['Project']['path'],'assets',a),d=g+'.meta',f=n['join'](Editor['Project']['path'],'assets',r),_=f+'.meta';let m,p;const y=async()=>{try{console['log']('['+e['_funcs']['getPluginName']()+']\x20Removing\x20runtime\x20script...'),t['existsSync'](l)&&(t['unlinkSync'](l),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20removed:\x20'+l)),t['existsSync'](g)&&(t['unlinkSync'](g),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20removed:\x20'+g)),t['existsSync'](f)&&(t['unlinkSync'](f),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20removed:\x20'+f)),t['existsSync'](u)&&(t['unlinkSync'](u),console['log']('['+e['_funcs']['getPluginName']()+']\x20Meta\x20file\x20removed:\x20'+u)),t['existsSync'](d)&&(t['unlinkSync'](d),console['log']('['+e['_funcs']['getPluginName']()+']\x20Meta\x20file\x20removed:\x20'+d)),t['existsSync'](_)&&(t['unlinkSync'](_),console['log']('['+e['_funcs']['getPluginName']()+']\x20Meta\x20file\x20removed:\x20'+_)),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+a);}catch(_0x192643){console['error']('['+e['_funcs']['getPluginName']()+']\x20Error\x20removing\x20runtime\x20script:',_0x192643);}},{pathExistsSync:S,writeFileSync:w,readFileSync:$}=require('fs-extra'),b={async 'open_main'(){console['log']('点击打开主面板'),Editor['Panel']['open'](e['packageJSON']['name']);},async 'restart_self_ui'(){console['log']('收到消息restart_self_ui'),await Editor['Panel']['close'](e['packageJSON']['name']);const _0x230674={[e['packageJSON']['name']+'.eval_panel']:!0x1,[e['packageJSON']['name']+'.log_panel']:!0x1,[e['packageJSON']['name']+'.dynamicTexture_panel']:!0x1,[e['packageJSON']['name']+'.localCache_panel']:!0x1};for(let _0x522303 in _0x230674)_0x230674[_0x522303]=await Editor['Panel']['has'](_0x522303),_0x230674[_0x522303]&&Editor['Panel']['close'](_0x522303);setTimeout(async()=>{console['log']('时间到重启'),await Editor['Panel']['open'](e['packageJSON']['name']);for(let _0x3dc689 in _0x230674)_0x230674[_0x3dc689]&&(await new Promise(_0x38c248=>{setTimeout(()=>{_0x38c248(null);},0x7d0);}),await Editor['Panel']['open'](_0x3dc689));},0x7d0);},async 'onBeforeBuild'(_0x35cb29){var _0x5416ea;const _0x16d1a3=null==(_0x5416ea=null==_0x35cb29?void 0x0:_0x35cb29['packages'])?void 0x0:_0x5416ea['cc_debuger_realtime'];return await(async _0x50e81c=>{const _0x1ba4ec=null==_0x50e81c?void 0x0:_0x50e81c['cut_plugin_from_runtime'],_0x23eadd=null==_0x50e81c?void 0x0:_0x50e81c['bAutoStarPlugin'],_0x1ff511=null==_0x50e81c?void 0x0:_0x50e81c['serverAddress'];if(t['existsSync'](l)){if(m=t['readFileSync'](l,'utf-8'),p=t['readFileSync'](u,'utf-8'),_0x1ba4ec)await y();else{let _0x1c6d7f=t['readFileSync'](l,'utf-8')['replace'](/bAutoStart\s*=\s*(true|false)/,'bAutoStart\x20=\x20'+_0x23eadd);_0x1c6d7f=_0x1c6d7f['replace'](/plugin_server_address\s*=\s*([`"'])(.*?)\1/,'plugin_server_address\x20=\x20`'+_0x1ff511+'`'),t['writeFileSync'](l,_0x1c6d7f,'utf-8'),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s);}return 0x0;}})(_0x16d1a3);},async 'onAfterBuild'(_0x46d331,_0x5cff1a,_0x2c8a23){var _0x19666e,_0x49b9bc;const _0x223338=null==(_0x19666e=null==_0x2c8a23?void 0x0:_0x2c8a23['cache'])?void 0x0:_0x19666e['applicationJS'];if(await S(_0x223338)){let _0xc0e77=$(_0x223338);_0xc0e77=_0xc0e77+'\x0a'+P,w(_0x223338,_0xc0e77);}return null==(_0x49b9bc=null==_0x46d331?void 0x0:_0x46d331['packages'])||_0x49b9bc['cc_debuger_realtime'],((async()=>{m&&t['writeFileSync'](l,m,'utf-8'),p&&t['writeFileSync'](u,p,'utf-8'),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s);})());}},P='\x0awindow[\x22cc_debuger_intercept_log\x22]\x20=\x20function(){\x0a\x20\x20if(!window[\x22cc_debuger_log_intercepted\x22]){\x0a\x20\x20\x20\x20window[\x22cc_debuger_log_intercepted\x22]\x20=\x20true;\x0a\x20\x20\x20\x20\x20\x20[\x22log\x22,\x20\x22warn\x22,\x20\x22error\x22].forEach(level\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20const\x20originalMethod\x20=\x20console[level];\x0a\x0a\x20\x20\x20\x20\x20\x20console[level]\x20=\x20(...args)\x20=>\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20if(window[\x22cc_debuger_handleLog\x22]){\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20window[\x22cc_debuger_handleLog\x22](level,\x20args);\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20return\x20originalMethod.apply(console,\x20args);\x0a\x20\x20\x20\x20\x20\x20};\x0a\x20\x20\x20\x20});\x0a\x20\x20}\x0a}\x0awindow[\x22cc_debuger_intercept_log\x22]()\x0a';exports['load']=function(){console['log']('插件\x20['+e['packageJSON']['name']+']\x20已安装'),((async()=>{try{console['log']('['+e['_funcs']['getPluginName']()+']\x20Injecting\x20runtime\x20script...');let _0xa184c5=!0x1;for(let _0x25cad7=0x0;_0x25cad7<0x78&&(_0xa184c5=await Editor['Message']['request']('asset-db','query-ready'),!_0xa184c5);_0x25cad7++)await e['_funcs']['waitForSeconds'](0x1);if(!_0xa184c5)return;{const _0x404eea=t['readFileSync'](i,'utf-8');t['writeFileSync'](f,_0x404eea,'utf-8'),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20written\x20to\x20'+f),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+r);}{const _0x4dc68b=t['readFileSync'](c,'utf-8');t['writeFileSync'](g,_0x4dc68b,'utf-8'),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20written\x20to\x20'+g),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+a);}{const _0x2c5427=t['readFileSync'](o,'utf-8');t['writeFileSync'](l,_0x2c5427,'utf-8'),console['log']('['+e['_funcs']['getPluginName']()+']\x20Runtime\x20script\x20written\x20to\x20'+l),await Editor['Message']['request']('asset-db','refresh-asset','db://assets/'+s);}}catch(_0x241fc4){console['error']('['+e['_funcs']['getPluginName']()+']\x20Error\x20injecting\x20runtime\x20script:',_0x241fc4);}})());},exports['methods']=b,exports['unload']=function(){console['log']('插件\x20['+e['packageJSON']['name']+']\x20已卸载'),y();};