'use strict';const e={'name':'cc_debuger_realtime','version':'1.0.10'},t=require('path'),n=require('net'),{exec:r,spawn:o}=require('child_process'),s=require('fs-extra'),i=require('os');exports['_funcs']=void 0x0,(_0x4b2adf=>{function _0x365daf(){return e['name'];}function _0x28d066(){return t['join'](Editor['Project']['path'],'extensions',e['name']);}_0x4b2adf['getPluginName']=_0x365daf,_0x4b2adf['getPluginVersionName']=function(){const _0x579c99=_0x28d066()+'/version.txt';let _0x52bbb5=s['readFileSync'](_0x579c99);if(_0x52bbb5['toString']&&(_0x52bbb5=_0x52bbb5['toString']()),'string'==typeof _0x52bbb5)_0x52bbb5=_0x52bbb5['trim'](),/^\d+(\.\d+)*$/['test'](_0x52bbb5)||(_0x52bbb5=e['version']);else _0x52bbb5=e['version'];return _0x52bbb5;},_0x4b2adf['getAssetInfoByUuid']=async function(_0x355a8d){return Editor['Message']['request']('asset-db','query-asset-info',_0x355a8d);},_0x4b2adf['getAssetMetaByUuid']=async function(_0xe193d){return Editor['Message']['request']('asset-db','query-asset-meta',_0xe193d);},_0x4b2adf['getUuidByUrl']=async function(_0x199692){return Editor['Message']['request']('asset-db','query-uuid',_0x199692);},_0x4b2adf['log_1']=function(..._0x27f52c){_0x27f52c['unshift']('[plugin]'),console['log']['apply'](console,_0x27f52c);},_0x4b2adf['getCurPluginPath']=_0x28d066,_0x4b2adf['waitForSeconds']=async function(_0x262b3d){return new Promise(_0x4f11ec=>{setTimeout(()=>{_0x4f11ec(null);},0x3e8*_0x262b3d);});},_0x4b2adf['getAllSubpathsFromUrl']=function(_0xa70b42){const _0xd57db4=_0xa70b42['replace'](/^[^:]+:\/+/,'')['split']('/'),_0x152822=[];let _0x3122e7='';for(let _0x4d9736=0x0;_0x4d9736<_0xd57db4['length'];_0x4d9736++)_0x3122e7=(_0x3122e7?_0x3122e7+'/':'')+_0xd57db4[_0x4d9736],_0x152822['push'](_0x3122e7);return _0x152822;},_0x4b2adf['getIconOfResType']=function(_0x18b3be){return'cc.SpriteFrame'===_0x18b3be||'cc.Texture2D'===_0x18b3be||'cc.ImageAsset'===_0x18b3be?'image':'cc.Prefab'===_0x18b3be?'prefab':'cc.SceneAsset'===_0x18b3be?'scene':'cc.Material'===_0x18b3be?'material':'cc.EffectAsset'===_0x18b3be?'effect':'cc.AudioClip'===_0x18b3be?'audio-clip':'cc.AnimationClip'===_0x18b3be?'animation-clip':'cc.JsonAsset'===_0x18b3be?'json':'cc.TextAsset'===_0x18b3be?'text':'cc.BitmapFont'===_0x18b3be?'bitmap-font':'cc.TTFFont'===_0x18b3be?'ttf-font':'cc.ParticleAsset'===_0x18b3be?'particle':'cc.SpriteAtlas'===_0x18b3be?'sprite-atlas':'cc.VideoClip'===_0x18b3be?'video':'cc.Mesh'===_0x18b3be?'mesh':'sp.SkeletonData'===_0x18b3be?'spine-data':'cc.AnimationClip'===_0x18b3be?'animation-clip':'unknown';},_0x4b2adf['getRuntimePreviewUrl']=async function(){return'http://localhost:'+await new Promise(_0x129691=>{Editor['Message']['request']('server','query-port')['then'](_0x42d7f4=>{_0x129691(_0x42d7f4);});})+'/';},_0x4b2adf['openWebSiteUrl']=function(_0xfbf89c){let _0xf0d6ea;switch(i['platform']()){case'win32':_0xf0d6ea='start\x20\x22\x22\x20\x22'+_0xfbf89c+'\x22';break;case'darwin':_0xf0d6ea='open\x20\x22'+_0xfbf89c+'\x22';break;case'linux':_0xf0d6ea='xdg-open\x20\x22'+_0xfbf89c+'\x22';break;default:return void console['error']('Unsupported\x20platform:\x20'+i['platform']());}r(_0xf0d6ea,(_0xd51ce0,_0x3d3d10,_0x51d662)=>{_0xd51ce0?console['error']('执行命令时出错:\x20'+_0xd51ce0):_0x51d662&&console['error']('标准错误输出:\x20'+_0x51d662);});},_0x4b2adf['waitForElementMounted']=async function(_0x42d282,_0x50f80a=0x64,_0x37029a=0x32){return _0x42d282['value']?_0x42d282['value']:new Promise(function(_0x24250d,_0x510da1){let _0x376a60=0x0;const _0x56a606=setInterval(()=>{_0x42d282['value']?(_0x24250d(_0x42d282['value']),clearInterval(_0x56a606)):_0x376a60>=_0x37029a?clearInterval(_0x56a606):_0x376a60++;},_0x50f80a);});},_0x4b2adf['clamp']=function(_0x2143cb,_0x5e1868,_0x12b281){if(_0x2143cb>_0x5e1868)throw new Error('min\x20should\x20be\x20less\x20than\x20or\x20equal\x20to\x20max');return Math['min'](Math['max'](_0x12b281,_0x2143cb),_0x5e1868);};const _0x4deda3=[];async function _0x534a3a(_0x3207a9){try{return await s['ensureDir'](_0x3207a9),_0x3207a9;}catch(_0x31a39c){return console['error']('操作文件夹时出错:\x20'+_0x31a39c['message']),null;}}async function _0x1507dc(){const _0x48ad59=_0x28d066()+'/cache',_0x31f443=_0x48ad59+'/localServer.json';return await _0x534a3a(_0x48ad59),_0x31f443;}_0x4b2adf['runCmdSpawn']=function(_0x193c76,_0x172d84,_0x43c033){return new Promise((_0x3f5858,_0x4678b3)=>{const _0x2d2a1d=o(_0x193c76,_0x172d84,{'shell':!0x0,..._0x43c033});_0x4deda3['push'](_0x2d2a1d),_0x2d2a1d['stdout']['on']('data',_0x2b7109=>{console['log']('[runCmdSpawn]:\x20'+_0x2b7109['toString']()['trim']());}),_0x2d2a1d['stderr']['on']('data',_0x217ed6=>{console['error']('[runCmdSpawn\x20Error]:\x20'+_0x217ed6['toString']()['trim']());}),_0x2d2a1d['on']('error',_0x18eabc=>{console['error']('[runCmdSpawn\x20Error]',_0x18eabc),_0x3f5858();}),_0x2d2a1d['on']('exit',_0x29d52d=>{_0x4deda3['splice'](_0x4deda3['indexOf'](_0x2d2a1d),0x1),console['log']('[runCmdSpawn]\x20Process\x20exited\x20with\x20code\x20'+_0x29d52d),_0x3f5858();});});},_0x4b2adf['stopSpawnProcess']=function(){for(let _0xba21b3 of _0x4deda3)_0xba21b3['kill']();_0x4deda3['length']=0x0;},_0x4b2adf['rgbaToHex']=function(_0x2089ae,_0x3c259b,_0x87b8ce,_0x3d7084){const _0x529e0d=_0x446405=>{const _0x5cfc4f=_0x446405['toString'](0x10);return 0x1===_0x5cfc4f['length']?'0'+_0x5cfc4f:_0x5cfc4f;};return'#'+_0x529e0d(_0x2089ae)+_0x529e0d(_0x3c259b)+_0x529e0d(_0x87b8ce)+_0x529e0d(_0x3d7084);},_0x4b2adf['findAvailablePort']=function _0x50aca7(_0xbd998d){return new Promise((_0x1bb981,_0x4254b7)=>{const _0x16d070=n['createServer']();_0x16d070['unref'](),_0x16d070['on']('error',()=>{_0x1bb981(_0x50aca7(_0xbd998d+0x1));}),_0x16d070['listen'](_0xbd998d,()=>{const _0x443f6e=_0x16d070['address']()['port'];_0x16d070['close'](()=>_0x1bb981(_0x443f6e));});});},_0x4b2adf['roundNumbersToPrecision']=function _0x1e90f1(_0x292e21,_0x400039=0x2){return null===_0x292e21||'object'!=typeof _0x292e21?'number'==typeof _0x292e21?Number(_0x292e21['toFixed'](_0x400039)):_0x292e21:Array['isArray'](_0x292e21)?_0x292e21['map'](_0x4d3ff1=>_0x1e90f1(_0x4d3ff1,_0x400039)):Object['keys'](_0x292e21)['reduce']((_0x6c1b54,_0x356e83)=>{const _0xd5b929=_0x292e21[_0x356e83];return _0x6c1b54[_0x356e83]='number'==typeof _0xd5b929?Number(_0xd5b929['toFixed'](_0x400039)):'object'==typeof _0xd5b929&&null!==_0xd5b929?_0x1e90f1(_0xd5b929,_0x400039):_0xd5b929,_0x6c1b54;},{});},_0x4b2adf['checkMouseIsInElemen']=function(_0x4df629,_0x2d716c){const _0x5eeb10=_0x4df629['getBoundingClientRect']();return _0x2d716c['clientX']>_0x5eeb10['x']&&_0x2d716c['clientX']<_0x5eeb10['x']+_0x5eeb10['width']&&_0x2d716c['clientY']>_0x5eeb10['y']&&_0x2d716c['clientY']<_0x5eeb10['y']+_0x5eeb10['height'];},_0x4b2adf['registerF5']=function(){window['addEventListener']('keyup',_0x46cffe=>{'F5'==_0x46cffe['key']&&Editor['Message']['send'](_0x4b2adf['getPluginName'](),'restart-self');});},_0x4b2adf['isValidURL']=function(_0x4be5b3){return new RegExp('^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\x5cS+(?::\x5cS*)?@)?(?:(?:(?:[1-9]\x5cd?|1\x5cd\x5cd|2[01]\x5cd|22[0-3])(?:\x5c.(?:1?\x5cd{1,2}|2[0-4]\x5cd|25[0-5])){2}(?:\x5c.(?:[0-9]\x5cd?|1\x5cd\x5cd|2[0-4]\x5cd|25[0-4]))|(?:(?:[a-z\x5cu00a1-\x5cuffff0-9]+-?)*[a-z\x5cu00a1-\x5cuffff0-9]+)(?:\x5c.(?:[a-z\x5cu00a1-\x5cuffff0-9]+-?)*[a-z\x5cu00a1-\x5cuffff0-9]+)*(?:\x5c.(?:[a-z\x5cu00a1-\x5cuffff]{2,})))|localhost)(?::\x5cd{2,5})?(?:(/|\x5c?|#)[^\x5cs]*)?$','i')['test'](_0x4be5b3);},_0x4b2adf['ensureFloderExist']=_0x534a3a,_0x4b2adf['getLocalIpv4IP']=function(){const _0x58d39d=i['networkInterfaces']();for(const _0x4d1e37 in _0x58d39d){const _0x2fea2a=_0x58d39d[_0x4d1e37];for(const _0x30f0af of _0x2fea2a)if('IPv4'===_0x30f0af['family']&&!_0x30f0af['internal'])return _0x30f0af['address'];}return'未找到\x20IP\x20地址';},_0x4b2adf['getLocalIPs']=function(){const _0x2f576e=i['networkInterfaces'](),_0x5ea7c3=[];for(const _0x344832 of Object['keys'](_0x2f576e))for(const _0x1993e1 of _0x2f576e[_0x344832])'IPv4'!==_0x1993e1['family']||_0x1993e1['internal']||_0x5ea7c3['push'](_0x1993e1['address']),'IPv6'!==_0x1993e1['family']||_0x1993e1['internal']||_0x5ea7c3['push'](_0x1993e1['address']);return _0x5ea7c3;},_0x4b2adf['checkIpIsLocalhost']=function(_0x4c69a2){const _0x2568f7=_0x4b2adf['getLocalIPs']();return!('localhost'!=_0x4c69a2&&'::1'!=_0x4c69a2&&'127.0.0.1'!=_0x4c69a2&&!_0x2568f7['includes'](_0x4c69a2));},_0x4b2adf['getFs']=function(){return s;},_0x4b2adf['getLocalServerJsonPath']=_0x1507dc,_0x4b2adf['saveCustomServerAddress']=async function(_0x3a35b5){const _0x4ed9f1=await _0x1507dc();let _0x920c1a=null;try{_0x920c1a=s['readJSONSync'](_0x4ed9f1);}catch(_0x6c5ea8){}_0x920c1a={'ip':null==_0x920c1a?void 0x0:_0x920c1a['ip'],'port':null==_0x920c1a?void 0x0:_0x920c1a['port'],'ws':_0x3a35b5},_0x920c1a['ip']||delete _0x920c1a['ip'],_0x920c1a['port']||delete _0x920c1a['port'],s['writeFileSync'](_0x4ed9f1,JSON['stringify'](_0x920c1a,null,0x4));};let _0x53f5ef=0x0;function _0x27cf9e(_0x26479a,_0x3c9b09){const _0x52a510=new Uint8Array(_0x26479a['length']);for(let _0x335f25=0x0;_0x335f25<_0x26479a['length'];_0x335f25++)_0x52a510[_0x335f25]=_0x26479a[_0x335f25]^_0x3c9b09[_0x335f25%_0x3c9b09['length']];return _0x52a510;}_0x4b2adf['printTime']=function(_0x1607d1,..._0x40e579){let _0x3e6029=Date['now']();0x0==_0x53f5ef||console['log'](_0x1607d1,_0x3e6029-_0x53f5ef,..._0x40e579),_0x53f5ef=_0x3e6029;},_0x4b2adf['getI18nText']=function(_0x29d909){_0x29d909=_0x365daf()+'.'+_0x29d909;let _0x51c369=Editor['I18n']['t'](_0x29d909);return''==_0x51c369&&_0x4b2adf['log_1']('i18n.'+_0x29d909+'为空'),_0x51c369;},_0x4b2adf['formatStr']=function(_0x4d3486,..._0x4fd427){return _0x4d3486['replace'](/\{(\d+)\}/g,function(_0x2246c4,_0x2ec591){return void 0x0!==_0x4fd427[_0x2ec591]?_0x4fd427[_0x2ec591]:_0x2246c4;});},_0x4b2adf['formatDate']=function(_0x577547,_0x1e80c5){let _0x3b0ffc=new Date();null!=_0x1e80c5&&_0x3b0ffc['setTime'](_0x1e80c5);var _0x2fe868={'M+':_0x3b0ffc['getMonth']()+0x1,'d+':_0x3b0ffc['getDate'](),'h+':_0x3b0ffc['getHours'](),'m+':_0x3b0ffc['getMinutes'](),'s+':_0x3b0ffc['getSeconds'](),'q+':Math['floor']((_0x3b0ffc['getMonth']()+0x3)/0x3),'S':_0x3b0ffc['getMilliseconds']()};for(var _0x5c6dc1 in(/(y+)/['test'](_0x577547)&&(_0x577547=_0x577547['replace'](RegExp['$1'],(_0x3b0ffc['getFullYear']()+'')['substr'](0x4-RegExp['$1']['length']))),_0x2fe868))new RegExp('('+_0x5c6dc1+')')['test'](_0x577547)&&(_0x577547=_0x577547['replace'](RegExp['$1'],0x1==RegExp['$1']['length']?_0x2fe868[_0x5c6dc1]:('00'+_0x2fe868[_0x5c6dc1])['substr']((''+_0x2fe868[_0x5c6dc1])['length'])));return _0x577547;},_0x4b2adf['openEvalPanel']=async function(_0x3769e7=''){const _0x3e1017=_0x4b2adf['getPluginName']()+'.eval_panel';await Editor['Panel']['has'](_0x3e1017)?Editor['Panel']['focus'](_0x3e1017):await Editor['Panel']['open'](_0x3e1017),_0x3769e7&&Editor['Message']['request'](_0x4b2adf['getPluginName'](),'setDefaultEvalStr',_0x3769e7);},_0x4b2adf['parseKey']=function(_0x2b356d){let _0x401fa5='';for(let _0xea5216=0x0;_0xea5216<_0x2b356d['length'];_0xea5216++){let _0x94617b=_0x2b356d[_0xea5216]['toString'](),_0x3dec59='';for(let _0x4a482f=0x0;_0x4a482f<_0x94617b['length'];_0x4a482f++)_0x3dec59+=(0x9-parseInt(_0x94617b['charAt'](_0x4a482f)))['toString']();_0x401fa5+=parseInt(_0x3dec59)['toString'](0x10)['padStart'](0x8,'0');}return _0x401fa5;},_0x4b2adf['str_encrypt']=function(_0x1cfcfb,_0x2cf455){if(null==_0x2cf455)return void console['log']('key\x20不能为空');const _0x193341=_0x27cf9e(new TextEncoder()['encode'](_0x1cfcfb),new TextEncoder()['encode'](_0x2cf455));let _0x56404d='';for(let _0x54c1b2=0x0;_0x54c1b2<_0x193341['length'];_0x54c1b2+=0x8000){const _0x4cc967=_0x193341['subarray'](_0x54c1b2,_0x54c1b2+0x8000);_0x56404d+=String['fromCharCode']['apply'](null,Array['from'](_0x4cc967));}return btoa(_0x56404d);},_0x4b2adf['str_decrypt']=function(_0x47a8c4,_0x321d58){if(null==_0x321d58)return void console['log']('key\x20不能为空');const _0x77abf6=atob(_0x47a8c4),_0x2b426e=new Uint8Array(_0x77abf6['length']);for(let _0x3566ad=0x0;_0x3566ad<_0x77abf6['length'];_0x3566ad+=0x8000){const _0x5ddad7=_0x77abf6['slice'](_0x3566ad,_0x3566ad+0x8000);for(let _0x20edfb=0x0;_0x20edfb<_0x5ddad7['length'];_0x20edfb++)_0x2b426e[_0x3566ad+_0x20edfb]=_0x5ddad7['charCodeAt'](_0x20edfb);}const _0x3f24e8=_0x27cf9e(_0x2b426e,new TextEncoder()['encode'](_0x321d58));return new TextDecoder()['decode'](_0x3f24e8);},_0x4b2adf['pako_deflate']=function(_0x34f62b){return pako['deflate'](_0x34f62b,{'to':'string'});},_0x4b2adf['pako_inflate']=function(_0x1e2c10){return pako['inflate'](_0x1e2c10,{'to':'string'});},_0x4b2adf['getStaticsInfo']=async function(){const _0x5b0a86=Editor['Project']['path'];console['log']('pPath',_0x5b0a86),console['log']('Editor.Project.tmpDir',Editor['Project']['tmpDir']);const _0x4cf8fd=t['join'](Editor['Project']['path'],'settings/v2/packages/project.json'),_0x39b91b=s['readJSONSync'](_0x4cf8fd);if(console['log']('projJson',_0x39b91b),null==this['_designSize']){const _0x1c98b2='const\x20{width,height}\x20=\x20cc.view.getDesignResolutionSize();return\x20{width,height}',_0x456086=await this['evalJsInRuntime'](_0x1c98b2);console['log']('执行',_0x456086);}},_0x4b2adf['getDesignResolutionSize']=function(){var _0x2c6362,_0x250614;const _0x1e6501=t['join'](Editor['Project']['path'],'settings/v2/packages/project.json');if(s['existsSync'](_0x1e6501))try{const _0x4ca262=s['readJSONSync'](_0x1e6501);if(null==(_0x2c6362=null==_0x4ca262?void 0x0:_0x4ca262['general'])?void 0x0:_0x2c6362['designResolution'])return null==(_0x250614=null==_0x4ca262?void 0x0:_0x4ca262['general'])?void 0x0:_0x250614['designResolution'];}catch(_0x2e791b){}return null;};})(exports['_funcs']||(exports['_funcs']={})),(function(){if(null!=globalThis['pako'])return;let _0x28a16f=t['join'](exports['_funcs']['getCurPluginPath'](),'src/tools/','pako.min.js'),_0x1dc0ce=s['readFileSync'](_0x28a16f,'utf-8');try{new Function(_0x1dc0ce)();}catch(_0x4f10a0){console['log'](_0x4f10a0);}}()),exports['packageJSON']=e;